<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js" type="text/javascript"></script>
    <script src="https://www.ourwoodbridge.net/Assets/Libs/BootStrap/4.0.0-alpha/dist/js/bootstrap.min.js"></script>
    <link href="https://www.ourwoodbridge.net/Assets/Libs/BootStrap/4.0.0-alpha/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
    <style>
        @import url(https://unpkg.com/@webpixels/css@1.1.5/dist/index.css);
        @import url("https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.4.0/font/bootstrap-icons.min.css");
    </style>
</head>
<body>
    <style>
        #myProgress {
            width: 100%;
            background-color: #ddd;
        }

        #myBar {
            width: 1%;
            height: 30px;
            background-color: #04AA6D;
        }
    </style>
    <div id="post"></div>
    <h1>JavaScript Progress Bar</h1>

    <div id="myProgress">
        <div id="myBar"></div>
    </div>

    <br>
    <button onclick="move()">Click Me</button>
    <script>

        $(window).load(function () {
            getGroups(2000)
        })



        function getGroups(NumOfDays) {
            try {
                var elem = document.getElementById("myBar")

                let selectedGroups = []
                let fileLocation = (window.location.hostname == "localhost") ? "/Discussion/list/28118/discussion-groups.html" : "/Discussion/list/28118/discussion-groups"
                $.get(fileLocation, function () { })
                    .done(function (responseText) {
                        let forums = new DOMParser().parseFromString(responseText, "text/html")
                        let forumName = forums.getElementsByClassName("clsBodyText")
                        let groupCheck = "(Group is included on My Woodbridge)"

                        for (let p = 2; p < forumName.length; p += 2) {
                            let includeGroup = forumName[p].innerText.includes(groupCheck)
                            if (includeGroup == true) {
                                let groupID = forumName[p - 1].getElementsByTagName("a")[0].id.replace("titleEditForum", "")
                                let groupName = forumName[p - 1].innerText
                                selectedGroups.push(groupID + "|" + groupName)
                            }
                            document.getElementById("post").appendChild(document.createTextNode(forumName[p - 1].getElementsByTagName("a")[0].id.replace("titleEditForum", "")))
                            document.getElementById("post").appendChild(document.createElement("br"))
                            elem.style.width = p*1.61 + "%"
                        }
                        /*showPosts(selectedGroups, NumOfDays)*/
                    })
            } catch { }
        }
        var i = 0
        function move() {
            if (i == 0) {
                i = 1
                var elem = document.getElementById("myBar")
                var width = 1
                var id = setInterval(frame, 10)
                function frame() {
                    if (width >= 100) {
                        clearInterval(id)
                        i = 0
                    } else {
                        width++
                        elem.style.width = width + "%"
                    }
                }
            }
        }
    </script>
</body>
</html>      