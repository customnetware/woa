<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js" type="text/javascript"></script>
    <script src="https://www.ourwoodbridge.net/Assets/Libs/BootStrap/4.0.0-alpha/dist/js/bootstrap.min.js"></script>
    <link href="https://www.ourwoodbridge.net/Assets/Libs/BootStrap/4.0.0-alpha/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
    <style>
        @import url(https://unpkg.com/@webpixels/css@1.1.5/dist/index.css);
        @import url("https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.4.0/font/bootstrap-icons.min.css");
    </style>
</head>
<body>
    <div id="post"></div>

    <script>

        $(window).load(function () {
            getGroups(365)
        })

        function getGroups(NumOfDays) {
            try {
                let fileLocation = (window.location.hostname == "localhost") ? "/Discussion/list/28118/discussion-groups.html" : "/Discussion/list/28118/discussion-groups"
                let selectedGroups = []                
                let currentDate = new Date()
                $.get(fileLocation, function () { })
                    .done(function (responseText) {
                        let forum = new DOMParser().parseFromString(responseText, "text/html")
                        let groups = forum.getElementById("contentInner").children
                        for (let p = 2; p < groups.length; p++) {
                            let lastPost = groups[p].getElementsByClassName("clsBodyItalic")[0].innerText
                            let groupName = groups[p].getElementsByClassName("clsBodyText")[0].innerText
                            let groupID = groups[p].getElementsByClassName("clsBodyText")[0].getElementsByTagName("a")[0].id.replace("titleEditForum", "")
                            let dateStart = lastPost.indexOf("Last Post:")
                            let postDate = (dateStart > -1) ? new Date(lastPost.substr(dateStart + 10, 18)) : new Date("01/01/1900")
                            let dayDiff = (currentDate - postDate) / (1000 * 3600 * 24)
                            if (dayDiff < NumOfDays) {
                                groupName = (groupName.includes(".")) ? groupName.split(".")[1] : groupName
                                document.getElementById("post").appendChild(document.createTextNode(groupName + " " + (postDate).toLocaleDateString() + " " + groupID))
                                document.getElementById("post").appendChild(document.createElement("br"))
                            }
                        }
                    })
            } catch { }
        }

    </script>
</body>
</html>      