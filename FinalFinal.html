<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js" type="text/javascript"></script>
    <script src="https://www.ourwoodbridge.net/Assets/Libs/BootStrap/4.0.0-alpha/dist/js/bootstrap.min.js"></script>
    <link href="https://www.ourwoodbridge.net/Assets/Libs/BootStrap/4.0.0-alpha/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
</head>
<body>
    <iframe id="woaFrame" src="/discussion/28118~11315~334766" title="Final WOA Code" style="display:none"></iframe>
    <input type="button" value="Save Post" id="postButton" style="margin-right:30px; cursor:pointer" />
    <script>
        document.getElementById("postButton").addEventListener("click", submitPost, false)
        function submitPost() {
            let frameWindow = document.getElementById('woaFrame').contentWindow
            frameWindow.AV.EditorLauncher.discussionTopic('334766', '11315', '', 'reply', 'Reply to Post', 'lnkTopicReply334766')


            let waitforForm = setInterval(function () {
                if (frameWindow.document.getElementsByTagName("iframe").length > 0) {
                    frameWindow.document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("txt_post_body").innerHTML = "This is a test to find the correct button"
                    frameWindow.document.getElementsByClassName("x-btn-text save-button")[0].click()
                    clearInterval(waitforForm)
                    pressButton()
                }
            }, 1000)
        }

        function pressButton() {
            let frameWindow = document.getElementById('woaFrame').contentWindow
            let waitforConfirm = setInterval(function () {
                if (frameWindow.document.getElementsByClassName(" x-btn-text").length > 0) {
                    let test = frameWindow.document.getElementsByClassName(" x-btn-text")
                    clearInterval(waitforConfirm)
                    for (let p = 0; p < test.length; p++) {
                        if (test[p].innerHTML =="Confirm")
                            test[p].click()
                    }             
                }

            }, 1000)
        }
    </script>



</body>

</html>