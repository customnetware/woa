<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js" type="text/javascript"></script>
    <script src="scripts/bootstrap.min.js"></script>
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>

</head>
<body>
    <div id="testDiv" style="margin-left: 100px; margin-right: 100px">
        <div id="resDisplayName" style="float: left; display: none;"></div>
        <div class="association-name" style="width:100%">
            <a href="/myWoodbridge.html">My Woodbridge</a>
            <a id="HeaderPublishAuthProfile" title="" class="text-nowrap" href="javascript:AV.MyProfileMenu.launch(10518615,28118,16860439,16764170);" style="float:right; padding-right:10px">My Profile</a>
        </div>

        <div id="woaContainer"> </div>

            <script>

                const woaCode = {
                    pageLocation: (pageName) => {
                        return (window.location.hostname == "localhost") ? pageName + ".html" : pageName
                    },
                    isDescendant: (parent, child) => {
                        let isParent = child.parentElement
                        while (isParent != null) {
                            if (isParent == parent) { return true }
                            isParent = isParent.parentElement
                        } return false
                    },
                    getPortalData: (dataSource, dataFunction) => {
                        $.get(dataSource)
                            .done(function (responseText) {
                                let portalContent = new DOMParser().parseFromString(responseText, "text/html")
                                dataFunction(portalContent)
                            })
                    },
                    getFiles: (portalContent) => {
                        let fileArray = []
                        let fileLink = "https://ourwoodbridge.net/ResourceCenter/Download/28118?doc_id=0000000&print=1&view=1"
                        let folderLink = "https://ourwoodbridge.net/ResourceCenter/28118~"
                        /*let docs = portalContent.getElementById("contents540434").querySelectorAll('[id^="d"]')*/
                        let docs = portalContent.querySelectorAll('[id^="d"]')
                   

                        for (let i = 0; i < docs.length; i++) {
                            let parentId = docs[i].parentElement.parentElement.parentElement.parentElement.id
                            let inFolder = portalContent.getElementById(parentId.replace("contents", "f")).innerHTML
                            let folderURL = folderLink + parentId.replace("contents", "")
                            let fileURL = fileLink.replace("0000000", docs[i].id.replace("d", ""))
                            fileArray.push(docs[i].innerHTML + "|" + fileURL + "|" + inFolder + "|" + folderURL)
                        }
                   
                        for (let d = 0, s = 1; d < fileArray.length && s <= 5; d++, s++) {

                            //let linkSpan = document.createElement("li")
                            //let docLink = document.createElement("a")
                            //docLink.innerHTML = fileArray[d].split("|")[0].trim() + " - "
                            //docLink.href = fileArray[d].split("|")[1].trim()

                            //let inLink = document.createElement("a")
                            //inLink.innerHTML = fileArray[d].split("|")[2].trim()
                            //inLink.href = fileArray[d].split("|")[3].trim()

                            //linkSpan.appendChild(docLink)
                            //linkSpan.appendChild(inLink)
          
                        }
                    },

                }

                woaCode.getPortalData(woaCode.pageLocation("/resourcecenter/28118/resource-center"), woaCode.getFiles)


            </script>
       
    </div>
</body>
</html>