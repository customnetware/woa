<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js" type="text/javascript"></script>
    <script src="https://www.ourwoodbridge.net/Assets/Libs/BootStrap/4.0.0-alpha/dist/js/bootstrap.min.js"></script>
    <link href="https://www.ourwoodbridge.net/Assets/Libs/BootStrap/4.0.0-alpha/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
</head>
<body>
    <style>
        #post p:nth-child(even) {
            background-color: #eceeef
        }

        #post p {
            margin: 0px;
            padding: 0px !important
        }

            #post p span {
                display: none;
            }

                #post p span:first-child {
                    font-weight: 700;
                    display: block
                }

                #post p span:nth-child(2) {
                    display: block
                }

                #post p span:nth-child(3) {
                    display: block
                }

                #post p span:nth-child(2n+4) {
                    margin-top: 5px;
                }
    </style>
    <div id="post" style="padding:10px;">

    </div>
    <script>
        $(window).load(function () { showPosts(8364) })
        function showPosts(groupID) {
            try {
                let selectedPost = (window.location.hostname == "localhost") ? "/Discussion/28118~" + groupID + ".html" : "/Discussion/28118~8364"
                $.get(selectedPost, function () { })
                    .done(function (responseText) {
                        let forumPosts = document.getElementById("post")
                        let forum = new DOMParser().parseFromString(responseText, "text/html")
                        let postHeaders = forum.querySelectorAll("[id^=msgHeader]")
                        let postContents = forum.querySelectorAll("[id^=contents]")
                        for (let h = 0; h < postHeaders.length; h++) {
                            let messageTexts = postContents[h].getElementsByClassName("clsBodyText")
                            let messageAuthor = postContents[h].getElementsByClassName("respAuthorWrapper")
                            let messageContacts = postContents[h].getElementsByClassName("respReplyWrapper")
                            let currentPost = document.createElement("p")
                            let postHeader = document.createElement("span")
                            let postMessage = document.createElement("span")
                            let postAuthor = document.createElement("span")
                            let postLink = document.createElement("a")
                            postLink.innerHTML = postHeaders[h].innerText
                            postLink.href = "javascript:showReplies(" + document.getElementById("post").getElementsByTagName("p").length + ")"
                            postHeader.appendChild(postLink)
                            postMessage.appendChild(document.createTextNode(messageTexts[0].innerText))
                            postAuthor.appendChild(document.createTextNode(messageAuthor[0].innerText))
                            currentPost.appendChild(postHeader)
                            currentPost.appendChild(postMessage)
                            currentPost.appendChild(postAuthor)
                            for (let p = 1; p < messageTexts.length; p++) {
                                let replyMessage = document.createElement("span")
                                let replyAuthor = document.createElement("span")
                                replyMessage.appendChild(document.createTextNode(messageTexts[p].innerText))
                                replyAuthor.appendChild(document.createTextNode(messageAuthor[p].innerText))
                                currentPost.appendChild(replyMessage)
                                currentPost.appendChild(replyAuthor)
                            }
                            forumPosts.appendChild(currentPost)
                        }
                    })
            } catch (error) {
                alert(error.message)
            }
        }
        function showReplies(p_id) {
            var testSpans = document.getElementById("post").getElementsByTagName("p")[p_id].getElementsByTagName("span")
            for (let p = 3; p < testSpans.length; p++) {
                if (testSpans[p].style.display == "block") { testSpans[p].style.display = "none" } else { testSpans[p].style.display = "block" }
            }
        }
    </script>
</body>
</html>