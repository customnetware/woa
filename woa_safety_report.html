<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js" type="text/javascript"></script>
    <script src="https://www.ourwoodbridge.net/Assets/Libs/BootStrap/4.0.0-alpha/dist/js/bootstrap.min.js"></script>
    <link href="https://www.ourwoodbridge.net/Assets/Libs/BootStrap/4.0.0-alpha/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
</head>
<body>
    <div style="width: 100%; float: left; padding:20px; margin-top:20px">
        <div id="resDisplayName" style="float: left; display: none;"></div>
        <div class="association-name"><a href="/28118">My Woodbridge</a></div>
        <div class="clsHeader" style="float:left; padding-right:25px"></div>
        <a id="HeaderPublishAuthProfile" title="" class="text-nowrap" href="javascript:AV.MyProfileMenu.launch(10518615,28118,16860439,16764170);" style="float:right; padding-right:10px">My Profile</a>
    </div>
    <div id="reports" style="padding:20px; width:100%; margin-left:auto; margin-right:auto"><span class="fa fa-circle-o-notch fa-pulse fa-fw fa-4x" id="loadIcon" style="width:100%; color:lightgray"></span>
    </div>
    <script>
        document.getElementsByClassName("clsHeader")[0].innerHTML = "Safety Concern Report (In Process & New)"
        const currentDate = new Date()
        let reportEnd = currentDate.getMonth() + 1 + "%2F" + currentDate.getDate() + "%2F" + currentDate.getFullYear()

        const fileLocation = (window.location.hostname == "localhost") ? "/Reports/Display2.html" : "/Reports/Display?report_id=1%7C317237&start_date=01%2F01%2F2015&end_date=" + reportEnd + "&format_id=6"
        $.get(fileLocation, function () { })
            .done(function (responseText) {
                let submittedForms = new DOMParser().parseFromString(responseText, "text/html")
                let formContents = submittedForms.getElementsByTagName("xmp")
                let formContentTx = formContents[0].innerText.replace(/"/g, "").split(/\r?\n|\r|\n/g)
                document.getElementById("loadIcon").style.display = "none"
                for (let s = 3; s < formContentTx.length; s++) {
                    if (formContentTx[s].split("|").length == 13) {
                        let reportContent = formContentTx[s].split("|")
                        let reportStatus = reportContent[4]
                        if (reportStatus !== "COMPLETE" && reportStatus !== "CANCELLED") {
                            let reportLine = document.createElement("p")
                            let reportTitle = document.createElement("b")
                            reportTitle.appendChild(document.createTextNode("Submitted by: " + reportContent[1] + " on " + reportContent[2] + " (" + reportStatus + ")"))
                            reportLine.appendChild(reportTitle)

                            reportLine.appendChild(document.createElement("br"))
                            reportLine.appendChild(document.createTextNode(reportContent[9]))
                            reportLine.appendChild(document.createElement("br"))
                            reportLine.appendChild(document.createTextNode("Response: " + reportContent[5]))
                            reportLine.appendChild(document.createElement("hr"))
                            document.getElementById("reports").appendChild(reportLine)
                        }
                    }
                }
            })
    </script>
</body>

</html>