<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js" type="text/javascript"></script>
    <script src="scripts/bootstrap.min.js"></script>
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>

</head>
<body>
    <div class="container-fluid">

        <div id="resDisplayName" style="float: left; display: none;"></div>
        <div class="association-name" style="width:100%">
            <a href="/myWoodbridge.html">My Woodbridge</a>
            <a id="HeaderPublishAuthProfile" title="" class="text-nowrap" href="javascript:AV.MyProfileMenu.launch(10518615,28118,16860439,16764170);" style="float:right; padding-right:10px">My Profile</a>
        </div>

        <div class="clsHeader" style="float: left; padding-right: 25px; width: 100%">My Documents</div>


        <div class="clsBodyText">
            <div is="customContainer">
                <style>
                    #recentDocuments {
                        width: 100% !important;
                        float: left;
                        padding-top: 5px;
                    }

                        #recentDocuments span {
                            padding-left: 10px;
                            padding-bottom: 5px;
                            padding-top: 5px;
                            font-weight: 600;
                            display: block;
                        }

                            #recentDocuments span:nth-child(odd) {
                                background-color: #eceeef
                            }

                        #recentDocuments a:nth-child(2n) {
                            float: right;
                        }

                    @media screen and (max-width:768px) {
                        .hideFromApp {
                            display: none;
                        }

                        .showFromApp {
                            display: block;
                        }
                    }

                    button {
                        cursor: pointer
                    }
                </style>

                <div class="row" style="margin-bottom:10px">
                    <div class="col-6" style="padding-right:5px;">
                        <button class="btn-block btn-outline-dark" style=" text-align: left;">
                            <span class="hideFromApp">Good Evening, WOA Webmaster</span>
                            <span class="showFromApp" style="display:none">WW</span>
                        </button>
                    </div>
                    <div class="col-2" style="padding:0px;padding-right:5px;">
                        <button class="btn-block" style="float:right;">
                            <span class="hideFromApp"> Help </span><span class="fa fa-question-circle-o fa-lg"></span>
                        </button>
                    </div>
                    <div class="col-2" style="padding:0px; padding-right:5px;">
                        <button class="btn-block" style="float:right;">
                            <span class="hideFromApp">  Ask A Manager</span> <span class="fa fa-envelope-o fa-lg"></span>
                        </button>
                    </div>
                    <div class="col-2" style="padding:0px; margin-left:0px">
                        <button class="btn-block" style="float:right;">
                            <span class="hideFromApp">Comment</span> <span class="fa fa-comments-o fa-lg"></span>
                        </button>
                    </div>
                </div>
                <div class="row" style="margin-bottom:10px">
                    <div class="col-12">
                        <img src="/HOA/assn28118/images/16764170/will_webb.jpg" style="width:110px; float:left; margin-right:10px; margin-bottom:10px;"><span>
                            Your personal home page (My Woodbridge) has been updated to better organize your notifications.&nbsp; To view more details about a type of notification please click on the title bar to expand it.&nbsp; One of the new features of My Woodbridge is that the webpage now will save emails from the Association Emails section.&nbsp; You also have the ability to view and respond to discussion group posts right from this page.&nbsp; In addition all available activity and event posters are available for download as well as any activity and event photos that have been uploaded. If you have any difficulties using this website please click here to contact the Our Woodbridge Website Webmaster.
                        </span>
                    </div>

                </div>
                <div class="row" style="margin-bottom:10px">
                    <div class="col-11" style="padding-right:5px">
                        <button class="btn-block" style=" text-align: left;">
                            <span class="fa fa-envelope-o" style="margin-right:5px"></span> Recent Emails
                        </button>
                    </div>
                    <div class="col-1" style="padding:0px; margin-left:0px">
                        <button class="btn-block"> <span class="fa fa-cog fa-spin fa-lg" aria-hidden="true" id="mailSpan"></span></button>
                    </div>
                    <div class="col-12" id="recentEmails"></div>
                </div>
                <div class="row" style="margin-bottom:10px">
                    <div class="col-11" style="padding-right:5px">
                        <button class="btn-block" style=" text-align: left;">
                            <span class="fa fa-file-o" style="margin-right:10px"></span> Recent Documents
                            <span class="fa fa-arrow-circle-o-right fa-lg" aria-hidden="true" style="float:right; padding-top:5px"></span><span style="float:right; padding-right:10px"> View </span>
                        </button>
                    </div>
                    <div class="col-1" style="padding:0px; margin-left:0px">
                        <button class="btn-block"> <span class="fa fa-cog fa-lg" aria-hidden="true"></span></button>
                    </div>
                    <div class="col-12" id="recentDocuments"></div>
                </div>
                <div class="row" style="margin-bottom:10px">
                    <div class="col-11" style="padding-right:5px">
                        <button class="btn-block" style=" text-align: left;">
                            <span class="fa fa-comments-o" style="margin-right:10px "></span> Recent Comments
                            <span class="fa fa-arrow-circle-o-down fa-lg" aria-hidden="true" style="float:right; padding-top:5px"></span><span style="float:right; padding-right:10px"> View </span>
                        </button>
                    </div>
                    <div class="col-1" style="padding:0px; margin-left:0px">
                        <button class="btn-block"> <span class="fa fa-cog fa-lg" aria-hidden="true"></span></button>
                    </div>
                    <div class="col-12" id="recentPosts"></div>
                </div>
                <script>
                    const newCode = {
                        getPortalData: (dataSource, dataFunction) => {
                            $.get(dataSource)
                                .done(function (responseText) {
                                    let portalContent = new DOMParser().parseFromString(responseText, "text/html")
                                    dataFunction(portalContent)
                                })
                        },
                        getEmails: (portalContent) => {
                            document.getElementById("mailSpan").className = "fa fa-cog fa-lg"
                            let recentEmails = portalContent.getElementById("panel_messages_content").getElementsByTagName("a")
                            for (let p = 0; p < recentEmails.length; p++) {
                                let emailDiv = document.createElement("div")
                                emailDiv.style.width = "100%"
                                emailDiv.style.marginBottom = "10px"
                                let emailHeader = document.createElement("a")
                                emailHeader.href = recentEmails[p].href
                                emailHeader.innerHTML = recentEmails[p].getAttribute("data-tooltip-title").split("by")[0].split(",")[0]
                                emailDiv.appendChild(emailHeader)
                                emailDiv.appendChild(document.createElement("br"))
                                emailDiv.appendChild(document.createTextNode(recentEmails[p].getAttribute("data-tooltip-text")))
                                emailDiv.appendChild(document.createElement("br"))
                                emailDiv.appendChild(document.createTextNode(recentEmails[p].getAttribute("data-tooltip-title").split("by")[0].split(",")[1]))
                                document.getElementById("recentEmails").appendChild(emailDiv)
                                localStorage.setItem(recentEmails[p].id, recentEmails[p].getAttribute("data-tooltip-title").split("by")[0].split(",")[0] + "|" + recentEmails[p].getAttribute("data-tooltip-text"))
                            }
                        },
                        getFiles: (portalContent) => {
                            let boardroom = "contents328201", flyers = "contents540434", newsletters = "contents951754"
                            let boardroomArray = [], flyersArray = [], newsletterArray = [], allArrays = [boardroomArray, flyersArray, newsletterArray]
                            let fileLink = "https://ourwoodbridge.net/ResourceCenter/Download/28118?doc_id=0000000&print=1&view=1"
                            let folderLink = "https://ourwoodbridge.net/ResourceCenter/28118~"
                            let docs = portalContent.querySelectorAll('[id^="d"]')
                            for (let i = 0; i < docs.length; i++) {
                                let currentDoc = docs[i].innerHTML.toLowerCase()
                                let reportFld01 = newCode.isDescendant(portalContent.getElementById(boardroom), docs[i])
                                let reportFld02 = newCode.isDescendant(portalContent.getElementById(newsletters), docs[i])
                                let reportFld03 = newCode.isDescendant(portalContent.getElementById(flyers), docs[i])
                                let parentId = docs[i].parentElement.parentElement.parentElement.parentElement.id
                                let inFolder = portalContent.getElementById(parentId.replace("contents", "f")).innerHTML
                                let folderURL = folderLink + parentId.replace("contents", "")
                                let fileURL = fileLink.replace("0000000", docs[i].id.replace("d", ""))
                                if (reportFld01 == true && docs[i].innerHTML.includes("2024") && (currentDoc.includes("agenda") || currentDoc.includes("minutes") || currentDoc.includes("packet"))) {
                                    boardroomArray.push(docs[i].innerHTML + "|" + fileURL + "|" + inFolder + "|" + folderURL)
                                }
                                if (reportFld02 == true) { newsletterArray.push(docs[i].innerHTML + "|" + fileURL + "|" + inFolder + "|" + folderURL) }
                                if (reportFld03 == true) { flyersArray.push(docs[i].innerHTML + "|" + fileURL + "|" + inFolder + "|" + folderURL) }
                            }
                            boardroomArray.sort()
                            boardroomArray.reverse()
                            newsletterArray.reverse()
                            for (let a = 0; a < allArrays.length; a++) {
                                for (let d = 0, s = 1; d < allArrays[a].length && s <= 5; d++, s++) {
                                    let linkSpan = document.createElement("span")
                                    let docLink = document.createElement("a")
                                    docLink.innerHTML = allArrays[a][d].split("|")[0].trim()
                                    docLink.href = allArrays[a][d].split("|")[1].trim()
                                    let inLink = document.createElement("a")
                                    inLink.innerHTML = allArrays[a][d].split("|")[2].trim()
                                    inLink.href = allArrays[a][d].split("|")[3].trim()
                                    linkSpan.appendChild(docLink)
                                    linkSpan.appendChild(inLink)
                                    document.getElementById("recentDocuments").appendChild(linkSpan)
                                }
                            }
                        },
                        getPosts: (portalContent) => {
                            let posts = portalContent.getElementsByClassName("ThreadContainer")[0], forumArray = []
                            for (let x = 0; x < posts.childElementCount; x++) {
                                let post = posts.children[x]
                                let lastDate = new Date(post.getElementsByClassName("respLastReplyDate")[0].innerText.trim().replace("Last Reply: ", ""))

                                let topic = post.getElementsByClassName("respDiscTopic")
                                let comments = post.getElementsByClassName("respDiscChildPost")
                                let posters = post.getElementsByClassName("respAuthorWrapper")
                                let contacts = post.getElementsByClassName("respReplyWrapper")
                                let dateSort = new Date(lastDate).getTime()
                                forumArray.push({
                                    postSort: dateSort, lastPost: lastDate, subject: topic[0].innerText.trim(), postContent: topic[1].innerText.trim(), postAuthor: posters[0].innerText.trim(),
                                    postID: contacts[0].getElementsByTagName("a")[0].id, replyLink: contacts[0].getElementsByTagName("a")[0].href, groupName: "General", groupID: "8030",
                                    numOfPost: comments.length
                                })
                            }
                            if (forumArray.length > 0) {
                                forumArray.sort((a, b) => { return a.postSort - b.postSort })
                                forumArray.reverse()
                                for (let p = 0; p <= 0; p++) {
                                    if (p < forumArray.length) {
                                        let post = document.createElement("div")
                                        let reply = document.createElement("a")
                                        let view = document.createElement("a")
                                        post.style.marginBottom = "15px"
                                        post.style.paddingLeft = "0px"
                                        post.innerHTML = "<b>" + forumArray[p].subject + " (Comments: " + forumArray[p].numOfPost + ") </b>"
                                        reply.href = forumArray[p].replyLink
                                        reply.innerHTML = forumArray[p].postAuthor + "  | Reply"
                                        view.href = "javascript:woaCode.showComments('" + forumArray[p].postID + "','" + forumArray[p].groupID + "')"
                                        view.innerHTML = " | View Comments"
                                        post.appendChild(document.createElement("br"))
                                        post.appendChild(document.createTextNode(forumArray[p].postContent))
                                        post.appendChild(document.createElement("br"))
                                        post.appendChild(reply)
                                        post.appendChild(view)
                                        document.getElementById("recentPosts").appendChild(post)
                                    }
                                }
                            }
                        },
                        isDescendant: (parent, child) => {
                            let isParent = child.parentElement
                            while (isParent != null) {
                                if (isParent == parent) { return true }
                                isParent = isParent.parentElement
                            } return false
                        },
                    }
                    newCode.getPortalData("/homepage/28118/resident-home-page.html", newCode.getEmails)
                    newCode.getPortalData("/resourcecenter/28118/resource-center.html", newCode.getFiles)
                    newCode.getPortalData("/Discussion/28118~8364.html", newCode.getPosts)
                    newCode.getPortalData("/Discussion/28118~8030.html", newCode.getPosts)
                    newCode.getPortalData("/Discussion/28118~11315.html", newCode.getPosts)
                </script>
            </div>
        </div>
    </div>


</body>
</html>